import re
import pandas as pd

# Your list of filenames
image_files = ['NAGFORM_MANUAL_page_100_img_1.png', 'NAGFORM_MANUAL_page_100_img_2.png', 'NAGFORM_MANUAL_page_100_img_3.png', 'NAGFORM_MANUAL_page_101_img_1.png', 'NAGFORM_MANUAL_page_101_img_2.png', 'NAGFORM_MANUAL_page_102_img_1.png', 'NAGFORM_MANUAL_page_103_img_1.png', 'NAGFORM_MANUAL_page_103_img_2.png', 'NAGFORM_MANUAL_page_103_img_3.png', 'NAGFORM_MANUAL_page_104_img_1.png', 'NAGFORM_MANUAL_page_104_img_2.png', 'NAGFORM_MANUAL_page_104_img_3.png', 'NAGFORM_MANUAL_page_105_img_1.png', 'NAGFORM_MANUAL_page_105_img_2.png', 'NAGFORM_MANUAL_page_105_img_3.png', 'NAGFORM_MANUAL_page_106_img_1.jpeg', 'NAGFORM_MANUAL_page_106_img_2.png', 'NAGFORM_MANUAL_page_106_img_3.jpeg', 'NAGFORM_MANUAL_page_106_img_4.png', 'NAGFORM_MANUAL_page_107_img_1.png', 'NAGFORM_MANUAL_page_107_img_2.jpeg', 'NAGFORM_MANUAL_page_107_img_3.jpeg', 'NAGFORM_MANUAL_page_107_img_4.png', 'NAGFORM_MANUAL_page_107_img_5.jpeg', 'NAGFORM_MANUAL_page_107_img_6.jpeg', 'NAGFORM_MANUAL_page_107_img_7.jpeg', 'NAGFORM_MANUAL_page_11_img_1.png', 'NAGFORM_MANUAL_page_11_img_2.png', 'NAGFORM_MANUAL_page_11_img_3.png', 'NAGFORM_MANUAL_page_11_img_4.png', 'NAGFORM_MANUAL_page_12_img_1.jpeg', 'NAGFORM_MANUAL_page_12_img_2.png', 'NAGFORM_MANUAL_page_13_img_1.png', 'NAGFORM_MANUAL_page_14_img_1.jpeg', 'NAGFORM_MANUAL_page_16_img_1.png', 'NAGFORM_MANUAL_page_17_img_1.png', 'NAGFORM_MANUAL_page_17_img_2.png', 'NAGFORM_MANUAL_page_18_img_1.png', 'NAGFORM_MANUAL_page_19_img_1.png', 'NAGFORM_MANUAL_page_1_img_1.jpeg', 'NAGFORM_MANUAL_page_1_img_2.png', 'NAGFORM_MANUAL_page_1_img_3.png', 'NAGFORM_MANUAL_page_1_img_4.png', 'NAGFORM_MANUAL_page_22_img_1.png', 'NAGFORM_MANUAL_page_23_img_1.png', 'NAGFORM_MANUAL_page_23_img_2.png', 'NAGFORM_MANUAL_page_23_img_3.png', 'NAGFORM_MANUAL_page_24_img_1.png', 'NAGFORM_MANUAL_page_24_img_2.png', 'NAGFORM_MANUAL_page_24_img_3.png', 'NAGFORM_MANUAL_page_25_img_1.png', 'NAGFORM_MANUAL_page_26_img_1.png', 'NAGFORM_MANUAL_page_27_img_1.png', 'NAGFORM_MANUAL_page_28_img_1.png', 'NAGFORM_MANUAL_page_28_img_2.png', 'NAGFORM_MANUAL_page_29_img_1.png', 'NAGFORM_MANUAL_page_30_img_1.png', 'NAGFORM_MANUAL_page_30_img_2.png', 'NAGFORM_MANUAL_page_31_img_1.png', 'NAGFORM_MANUAL_page_31_img_2.png', 'NAGFORM_MANUAL_page_32_img_1.png', 'NAGFORM_MANUAL_page_33_img_1.png', 'NAGFORM_MANUAL_page_33_img_2.png', 'NAGFORM_MANUAL_page_34_img_1.png', 'NAGFORM_MANUAL_page_34_img_2.png', 'NAGFORM_MANUAL_page_36_img_1.jpeg', 'NAGFORM_MANUAL_page_38_img_1.jpeg', 'NAGFORM_MANUAL_page_39_img_1.png', 'NAGFORM_MANUAL_page_40_img_1.png', 'NAGFORM_MANUAL_page_41_img_1.png', 'NAGFORM_MANUAL_page_42_img_1.png', 'NAGFORM_MANUAL_page_43_img_1.png', 'NAGFORM_MANUAL_page_43_img_2.png', 'NAGFORM_MANUAL_page_45_img_1.png', 'NAGFORM_MANUAL_page_45_img_2.png', 'NAGFORM_MANUAL_page_46_img_1.png', 'NAGFORM_MANUAL_page_46_img_2.png', 'NAGFORM_MANUAL_page_47_img_1.jpeg', 'NAGFORM_MANUAL_page_51_img_1.png', 'NAGFORM_MANUAL_page_51_img_2.jpeg', 'NAGFORM_MANUAL_page_51_img_3.png', 'NAGFORM_MANUAL_page_51_img_4.jpeg', 'NAGFORM_MANUAL_page_51_img_5.png', 'NAGFORM_MANUAL_page_51_img_6.png', 'NAGFORM_MANUAL_page_51_img_7.png', 'NAGFORM_MANUAL_page_52_img_1.png', 'NAGFORM_MANUAL_page_52_img_2.png', 'NAGFORM_MANUAL_page_52_img_3.png', 'NAGFORM_MANUAL_page_53_img_1.png', 'NAGFORM_MANUAL_page_54_img_1.png', 'NAGFORM_MANUAL_page_55_img_1.png', 'NAGFORM_MANUAL_page_56_img_1.png', 'NAGFORM_MANUAL_page_57_img_1.png', 'NAGFORM_MANUAL_page_58_img_1.png', 'NAGFORM_MANUAL_page_59_img_1.png', 'NAGFORM_MANUAL_page_59_img_2.png', 'NAGFORM_MANUAL_page_60_img_1.png', 'NAGFORM_MANUAL_page_60_img_2.png', 'NAGFORM_MANUAL_page_61_img_1.jpeg', 'NAGFORM_MANUAL_page_61_img_2.png', 'NAGFORM_MANUAL_page_62_img_1.png', 'NAGFORM_MANUAL_page_62_img_2.png', 'NAGFORM_MANUAL_page_64_img_1.png', 'NAGFORM_MANUAL_page_64_img_2.png', 'NAGFORM_MANUAL_page_64_img_3.png', 'NAGFORM_MANUAL_page_64_img_4.png', 'NAGFORM_MANUAL_page_64_img_5.png', 'NAGFORM_MANUAL_page_64_img_6.png', 'NAGFORM_MANUAL_page_65_img_1.png', 'NAGFORM_MANUAL_page_65_img_2.png', 'NAGFORM_MANUAL_page_65_img_3.png', 'NAGFORM_MANUAL_page_66_img_1.png', 'NAGFORM_MANUAL_page_66_img_2.png', 'NAGFORM_MANUAL_page_67_img_1.png', 'NAGFORM_MANUAL_page_68_img_1.png', 'NAGFORM_MANUAL_page_69_img_1.png', 'NAGFORM_MANUAL_page_70_img_1.png', 'NAGFORM_MANUAL_page_70_img_2.png', 'NAGFORM_MANUAL_page_71_img_1.png', 'NAGFORM_MANUAL_page_71_img_2.png', 'NAGFORM_MANUAL_page_72_img_1.png', 'NAGFORM_MANUAL_page_72_img_2.png', 'NAGFORM_MANUAL_page_73_img_1.png', 'NAGFORM_MANUAL_page_74_img_1.png', 'NAGFORM_MANUAL_page_74_img_2.png', 'NAGFORM_MANUAL_page_75_img_1.png', 'NAGFORM_MANUAL_page_76_img_1.png', 'NAGFORM_MANUAL_page_76_img_2.png', 'NAGFORM_MANUAL_page_76_img_3.png', 'NAGFORM_MANUAL_page_77_img_1.png', 'NAGFORM_MANUAL_page_77_img_2.png', 'NAGFORM_MANUAL_page_77_img_3.png', 'NAGFORM_MANUAL_page_78_img_1.png', 'NAGFORM_MANUAL_page_78_img_2.png', 'NAGFORM_MANUAL_page_79_img_1.png', 'NAGFORM_MANUAL_page_79_img_2.png', 'NAGFORM_MANUAL_page_79_img_3.png', 'NAGFORM_MANUAL_page_79_img_4.png', 'NAGFORM_MANUAL_page_80_img_1.png', 'NAGFORM_MANUAL_page_80_img_2.png', 'NAGFORM_MANUAL_page_81_img_1.png', 'NAGFORM_MANUAL_page_81_img_2.png', 'NAGFORM_MANUAL_page_82_img_1.png', 'NAGFORM_MANUAL_page_82_img_2.png', 'NAGFORM_MANUAL_page_82_img_3.png', 'NAGFORM_MANUAL_page_82_img_4.png', 'NAGFORM_MANUAL_page_83_img_1.png', 'NAGFORM_MANUAL_page_83_img_2.png', 'NAGFORM_MANUAL_page_84_img_1.png', 'NAGFORM_MANUAL_page_84_img_2.png', 'NAGFORM_MANUAL_page_85_img_1.png', 'NAGFORM_MANUAL_page_86_img_1.png', 'NAGFORM_MANUAL_page_86_img_2.png', 'NAGFORM_MANUAL_page_87_img_1.png', 'NAGFORM_MANUAL_page_87_img_2.png', 'NAGFORM_MANUAL_page_88_img_1.png', 'NAGFORM_MANUAL_page_88_img_2.png', 'NAGFORM_MANUAL_page_89_img_1.png', 'NAGFORM_MANUAL_page_8_img_1.jpeg', 'NAGFORM_MANUAL_page_90_img_1.png', 'NAGFORM_MANUAL_page_90_img_2.png', 'NAGFORM_MANUAL_page_90_img_3.png', 'NAGFORM_MANUAL_page_91_img_1.jpeg', 'NAGFORM_MANUAL_page_91_img_2.png', 'NAGFORM_MANUAL_page_93_img_1.png', 'NAGFORM_MANUAL_page_93_img_2.png', 'NAGFORM_MANUAL_page_94_img_1.png', 'NAGFORM_MANUAL_page_94_img_2.png', 'NAGFORM_MANUAL_page_97_img_1.png', 'NAGFORM_MANUAL_page_97_img_2.png', 'NAGFORM_MANUAL_page_98_img_1.png', 'NAGFORM_MANUAL_page_99_img_1.png']

# Function to extract page and image numbers
def extract_numbers(filename):
    match = re.search(r'page_(\d+)_img_(\d+)', filename)
    if match:
        return int(match.group(1)), int(match.group(2))
    return float('inf'), float('inf')

# Sort naturally
sorted_files = sorted(image_files, key=extract_numbers)

# Create DataFrame
df = pd.DataFrame({
    "image": sorted_files,
    "description": [""] * len(sorted_files)
})

# Save to CSV
csv_path = "D:/Work/multimodal-rag/data/NAGFORM_MANUAL.csv"
df.to_csv(csv_path, index=False)

print(f"CSV saved as {csv_path}")